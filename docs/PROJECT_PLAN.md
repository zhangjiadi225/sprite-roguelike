# 精灵肉鸽 (Sprite Roguelike) - 项目规划

## 项目概述

**类型：** 像素风格肉鸽宝可梦游戏  
**核心玩法：** 精灵捕捉 + 融合系统 + Roguelike探索  
**技术栈：** Next.js + Phaser 3 + TypeScript + Vite  
**目标平台：** 网页端、小程序、桌面应用

---

## 核心创新点

### 🧬 精灵融合系统
- **肢体继承机制**：精灵由多个部位组成（头、耳朵、身体、腿、尾巴、翅膀）
- **随机组合**：融合时每个部位独立继承父代之一
- **示例**：兔子 + 马 → 长兔耳朵的马 或 腿很长的兔子
- **唯一性**：每次融合生成独特外观，基于像素数据

### 🎮 局外系统
- 死亡后可带出1只精灵到局外
- 局外可继续融合精灵
- 下次游戏可选择携带局外精灵

---

## 游戏设计

### 属性系统
- **5种属性**：火、电、毒、冰、虚空
- **相克关系**：火→冰→电→毒→火（循环克制）
- **虚空**：不克制也不被克制（平衡属性）

### 精灵系统
**基础属性：**
- HP（血量）
- ATK（攻击）
- DEF（防御）
- SPD（速度）
- 成长值（影响升级属性增长）

**等级系统：**
- 等级范围：1-50
- 通过战斗获得经验升级

**融合机制：**
- 消耗2只精灵 → 生成1只新精灵
- 新等级 = (A等级 + B等级) / 2（向下取整）
- 成长值 = (A成长值 + B成长值) × 1.1
- 属性：随机选择父代之一
- 技能：各保留1个保底技能 + 随机继承1-2个
- **外观：肢体部位独立继承**

**精灵尺寸：**
- 基础：16×16 像素
- 融合次数多可能变大（16×16 → 24×24 → 32×32）

**精灵结构：**
```typescript
interface SpriteBody {
  head: PixelData;      // 头部
  ears: PixelData;      // 耳朵
  body: PixelData;      // 身体
  legs: PixelData;      // 腿部
  tail?: PixelData;     // 尾巴（可选）
  wings?: PixelData;    // 翅膀（可选）
}
```

### 战斗系统
- **回合制**：传统宝可梦式
- **速度决定出手顺序**
- **伤害计算**：基础伤害 × 属性克制 × 随机系数(0.85-1.0)
- **技能系统**：每只精灵2-4个技能，有PP值限制

### 捕捉系统
- 野生精灵可用精灵球捕捉
- 成功率 = (1 - 当前HP/最大HP) × 基础成功率
- 失败消耗精灵球

### 道具系统
**货币：** 精灵币

**道具类型：**
- 回复类：生命药水、全恢复药
- 捕捉类：普通精灵球、高级精灵球
- 融合类：融合石（融合必需）
- 强化类：经验糖果、成长药剂

### 地图系统
**5个关卡：**
1. 新手区（简单）
2. 森林区（普通）
3. 洞窟区（困难）
4. 火山区（精英）
5. 虚空区（Boss）

**房间类型：**
- 战斗房（70%）：遇到野生精灵
- 商店房（15%）：购买道具
- 宝箱房（10%）：随机奖励
- Boss房（5%）：Boss战

### 局外系统
- 精灵仓库（存放带出的精灵）
- 融合实验室（局外融合）
- 难度选择（简单/普通/困难）

---

## MVP 范围

### 最小可玩版本目标
**核心功能：**
1. ✅ 基础框架搭建
2. 🎯 5种基础精灵（火、电、毒、冰、虚空各1只）
3. 🎯 精灵融合系统（肢体继承）
4. 🎯 简单战斗系统
5. 🎯 1-2个关卡
6. 🎯 基础UI

**MVP 验证点：**
- 能捕捉精灵
- 能融合精灵并看到独特外观
- 能进行战斗
- 能体验完整的一局游戏

### 暂不实现（后续版本）
- 完整5个关卡
- 商店系统
- 局外系统
- 音效音乐
- 复杂道具
- 难度选择

---

## 开发计划

### Phase 1: 核心框架 ⏳
- [ ] Next.js + Phaser 3 项目搭建
- [ ] 基础场景（菜单、游戏、战斗）
- [ ] 精灵数据结构
- [ ] 简单地图生成

### Phase 2: 精灵系统（MVP核心）🎯
- [ ] 5种基础精灵设计（分肢体设计）
- [ ] 精灵渲染系统
- [ ] **肢体融合算法**
- [ ] 融合UI和预览

### Phase 3: 战斗系统 🎯
- [ ] 回合制战斗逻辑
- [ ] 简单技能系统
- [ ] 属性相克计算
- [ ] 战斗UI

### Phase 4: 游戏循环 🎯
- [ ] 捕捉系统
- [ ] 背包系统
- [ ] 1-2个关卡
- [ ] 胜利/失败条件

### Phase 5: 优化和完善
- [ ] UI/UX 优化
- [ ] 平衡性调整
- [ ] Bug 修复

---

## 技术架构

### 技术栈
- **框架**：Next.js 14+
- **游戏引擎**：Phaser 3
- **语言**：TypeScript
- **构建工具**：Vite
- **状态管理**：Zustand（可选）
- **样式**：Tailwind CSS

### 项目结构
```
sprite-roguelike/
├── src/
│   ├── app/              # Next.js app router
│   ├── game/             # Phaser 游戏代码
│   │   ├── scenes/       # 游戏场景
│   │   ├── entities/     # 游戏实体
│   │   ├── systems/      # 游戏系统
│   │   └── data/         # 游戏数据
│   ├── components/       # React 组件
│   └── lib/              # 工具函数
├── public/
│   └── assets/           # 游戏资源
└── docs/                 # 文档
```

---

## 当前状态

**进度：** 项目初始化完成  
**Git 仓库：** https://github.com/zhangjiadi225/sprite-roguelike  
**本地路径：** D:\web\sprite-roguelike  
**下一步：** 开始 Phase 1 - 核心框架搭建

---

## 开发方式

- 使用 **Codex** 进行开发
- 优先级：框架 → 精灵融合 MVP → 战斗系统
- 迭代式开发，先做出可玩原型

---

**最后更新：** 2026-02-25
